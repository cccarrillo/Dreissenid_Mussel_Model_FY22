# #legend for initial infected
# legend("bottom", legend=as.factor(unique(init_dat@data$Infected)), pch=16, col = "red",
#       pt.bg="red", pt.cex=1, title="Initial Infected", bty="n", ncol = 2)
# title(main = "Infection based on Time Step", sub = "Null no buffer Survive 100")
# #dev.off()
#IRIS'S ATTEMPT WITH SF PACKAGE
library(sf) #for spatial data
library(scales) #for color scales
library(viridis)
#Read this in as sf object
USmaps_sf <- read_sf(here("Carra_Lakes.shp"))
TXmaps_sf <- read_sf(here("State.shp"))
#Convert these to sp objects to sf
infected_dat_first_sf <- st_as_sf(infect_dat_first)
init_infect_dat_sf <- st_as_sf(init_infect_dat) %>% mutate(newtimestep = "Initially Infested")
combined_sort_sf <- st_as_sf(combined)
#Remove lakes from infected_dat_first if they are initially infected
combined_sort_sf <- combined_sort_sf %>%
filter(!FID %in% c(init_infect_dat_sf$FID))
#rbind initially infected with infected first, create factor version of newtimestep
infect_timestep <- rbind(combined_sort_sf , init_infect_dat_sf %>% mutate(HSI = NA)) %>%
mutate(time_to_infect = as.character(newtimestep)) #%>%
#if timestep is 0, lake is initially infected, if it is 6, it is never infected
# mutate(time_to_infect = case_when(time_to_infect == 0 ~ "Initially Infected",
#                                  T ~ time_to_infect))
#order factor levels
infect_timestep$time_to_infect <- factor(infect_timestep$time_to_infect, levels = c("Initially Infested", "No Modeled Infestation", "1", "2", "3", "4", "5", "6"), ordered = T)
#check factor levels
levels(infect_timestep$time_to_infect)
col2rgb(c("lightblue","lightgreen","pink"))
t_col <- function(color, percent = 50, name = NULL) {
rgb.val <- col2rgb(color)
t.col <- rgb(rgb.val[1], rgb.val[2], rgb.val[3], max = 255, alpha = (100 - percent) * 255/100, names = name)
invisible(t.col)
}
t_col <- t_col("gray80", perc = 50, name = "lt.gray")
#set up colors (and color names for legend)
timestep_colors <- c("red",t_col, viridis(6))
names(timestep_colors) <-  c("Initially Infested", "No Modeled Infestation", "1", "2", "3", "4", "5", "6")
#ggplot
ggplot() +
#plot the us map data
geom_sf(data = USmaps_sf) +
#then add the infected lake data
geom_sf(data = TXmaps_sf) +
geom_sf(data = infect_timestep, aes(color = time_to_infect)) +
#use timestep colors
scale_color_manual(values = timestep_colors) +
#title of legend
labs(color = "Time to Infection") +
#use theme_void so we dont have grid lines
theme_void() +
#plot title
labs(title = "HSI, 100 mi Buffer, 25% Cleaning") +
#set title size and legend position
theme(plot.title = element_text(hjust = 0.5),
legend.position = "left")
#This line will save the last ggplot rendered (so the plot above will be saved)
ggsave(here("Infect_Plot_HSI_Buff_100_25_Percent_Cleaning_Station.png"), bg = "white")
knitr::opts_chunk$set(echo = TRUE)
#install.packages("unikn")
library(tidyverse) # library to read excel files
library(readxl)
library(writexl)
library(ggplot2)
library(here) #this automatically sets working directory to location of file
#library(cowplot)
#library(unikn)
#library(patchwork)
library(rgdal) # library for GIS functions
library(sp) # library for GIS functions (dependency for rgdal)
# read in excel file, arguments are file name and sheet name
#setwd("C:/Users/RDEL1CMC/Desktop/JA/Second_Revision/Results_08232022")
#instead of file path, Iris used here() fun to set wd
init_infect_dat <- read_xlsx(here("initial_infected.xlsx"))
init_dat <- read_xlsx(here("initial_uninfected.xlsm"))
dat <- read_xlsx(here("HSI_Buff_100_50_Percent_Cleaning_Station.xlsx"), sheet="Lake_Results_0")
# subset by only infections (i.e. Infections = True; column Infected. == T)
# The "," in the brackets after "T" means to select all rows
infect_dat <- dat[dat$Infected==TRUE,]
#init_dat is the initial infected data file that also has the uninfected lakes
# Note, there are probably a lot of ways to do this part
# Sort data in ascending order by Iteration and Lake, so all lakes infected at
# time step 0 are listed in alphabetical order
infect_dat_sort <- infect_dat[with(infect_dat, order(Iteration, Lake)),]
#sort initial infected data by iteration and lake
# Select the time step when lake is first infected
# the "!" means not, so this is selecting the rows where where the Lake name is
# not duplicated (i.e. the first time it occurs in the data frame)
infect_dat_first <- infect_dat_sort[!duplicated(infect_dat_sort$Lake),]
infect_dat_first$newtimestep <- infect_dat_first$Iteration+1
init_dat$newtimestep <- init_dat$Iteration
#NOTE. Iris did not use this code at all...just double checking I used the right data!
# save dataset as Excel file -- the row.names=F argument means not to include
# column in Excel sheet with index value
write_xlsx(infect_dat_first, "HSI_Buff_100_50_Percent_Cleaning_Station.xlsx")
#combine the excel files into one file to plot
#lake is never infected if FID is in the init dat but not in the infect dat first
never_infected <- init_dat %>% filter(!FID %in% c(infect_dat_first$FID)) %>% mutate(newtimestep = "No Modeled Infestation")
#Iris added a HSI column so they would bind
#Carra rearranged to get the never infested lakes to show up on the bottom of the image
combined <- rbind(infect_dat_first, never_infected %>% mutate(HSI = NA))
combined
combined_sort <- combined[with(combined, order(Lake, Iteration)),]
combined_sort
combined_sort$Lake[combined_sort$Infected==T & combined_sort$Iteration==0]
#pulling out initially infected lakes based on FID
combined_sort__not_initially_infected <-combined_sort[combined_sort$FID %in% c(53, 87, 90, 138, 180, 213, 216, 217, 220, 221, 317),]
combined_sort__not_initially_infected
combined_sort$newtimestep[combined_sort$FID %in% c(53, 87, 90, 138, 180, 213, 216, 217, 220, 221, 317)] = 0
combined_sort
# Convert to spatial points data frame and project in WGS84 (i.e. Degrees)
# The CRS stands for coordinate reference system and I googled the code to put in (4326)
coordinates(combined) <- ~Longitude+Latitude
proj4string(combined) <- CRS("+init=epsg:4326")
coordinates(infect_dat_first) <- ~Longitude+Latitude
proj4string(infect_dat_first) <- CRS("+init=epsg:4326")
coordinates(init_infect_dat) <- ~Longitude+Latitude
proj4string(init_infect_dat) <- CRS("+init=epsg:4326")
coordinates(init_dat) <- ~Longitude+Latitude
proj4string(init_dat) <- CRS("+init=epsg:4326")
# Save Spatial Points data frame as shapefile
# Note, this abbreviates the field names
writeOGR(combined, "infect_dat_first_HSI_Buff_100_50_Percent_Cleaning_Station.shp", layer="infect_dat_first", driver="ESRI Shapefile")
# USmaps <- readOGR(#"C:/Users/RDEL1CMC/Desktop/JA/Second_Revision/Results_08232022",
#                   "US_STATES.shp")
# USBR_INPUT <-readOGR(#"C:/Users/RDEL1CMC/Desktop/JA/Second_Revision/Results_08232022",
#                      "USBR_INPUT.shp")
# us_lakes <- readOGR(#"C:/Users/RDEL1CMC/Desktop/JA/Second_Revision/Results_08232022",
#   "Waterbodies_High_Res_NHD_1000ft_From_Site_Join_Final_6_1_18_A.shp")
# # Time of Infection PlotNuk
# #png("Infect_Plot_HSI_Buff_100.png")
# plot(USmaps)
# plot(us_lakes, add=TRUE)
# plot(combined_sort, bg=as.factor(combined_sort@data$newtimestep), pch=16, cex=1, col = 1:6, add = TRUE)
#
# #plots initial uninfected data
# (plot(init_dat, bg=as.factor(init_dat@data$Infected), pch=16, cex=1, col = 1, add = TRUE))
#
# #plots the time step that infected lakes become infected
# plot(infect_dat_first, bg=as.factor(infect_dat_first@data$newtimestep), pch=16, cex=1, col = 3:7, add = TRUE)
#
# #plots the initial 11 infected lakes
# plot(init_dat, bg=as.factor(init_dat@data$Infected), pch=16, cex=1, col = 10, add = TRUE)
#
#
# #legend for the time step of infection
# legend("bottomleft", legend=as.factor(unique(combined_sort@data$newtimestep)), pch=21, col = 1:6, pt.bg=palette()[1:6],
#              pt.cex=1, title="Time of Infection", bty="n", ncol = 2)
# legend("bottomleft", legend=as.factor(unique(infect_dat_first@data$newtimestep)), pch=21, col = 3:7,
#              pt.bg=palette()[3:7], pt.cex=1, title="Time of Infection", bty="n", ncol = 2)
# #legend for initial uninfected
# legend("bottomright", legend=as.factor(unique(init_dat@data$Iteration)), pch=16,
#        pt.bg=palette()[9], pt.cex=1, title="initial Uninfected", bty="n", ncol = 2)
# #legend for initial infected
# legend("bottom", legend=as.factor(unique(init_dat@data$Infected)), pch=16, col = "red",
#       pt.bg="red", pt.cex=1, title="Initial Infected", bty="n", ncol = 2)
# title(main = "Infection based on Time Step", sub = "Null no buffer Survive 100")
# #dev.off()
#IRIS'S ATTEMPT WITH SF PACKAGE
library(sf) #for spatial data
library(scales) #for color scales
library(viridis)
#Read this in as sf object
USmaps_sf <- read_sf(here("Carra_Lakes.shp"))
TXmaps_sf <- read_sf(here("State.shp"))
#Convert these to sp objects to sf
infected_dat_first_sf <- st_as_sf(infect_dat_first)
init_infect_dat_sf <- st_as_sf(init_infect_dat) %>% mutate(newtimestep = "Initially Infested")
combined_sort_sf <- st_as_sf(combined)
#Remove lakes from infected_dat_first if they are initially infected
combined_sort_sf <- combined_sort_sf %>%
filter(!FID %in% c(init_infect_dat_sf$FID))
#rbind initially infected with infected first, create factor version of newtimestep
infect_timestep <- rbind(combined_sort_sf , init_infect_dat_sf %>% mutate(HSI = NA)) %>%
mutate(time_to_infect = as.character(newtimestep)) #%>%
#if timestep is 0, lake is initially infected, if it is 6, it is never infected
# mutate(time_to_infect = case_when(time_to_infect == 0 ~ "Initially Infected",
#                                  T ~ time_to_infect))
#order factor levels
infect_timestep$time_to_infect <- factor(infect_timestep$time_to_infect, levels = c("Initially Infested", "No Modeled Infestation", "1", "2", "3", "4", "5", "6"), ordered = T)
#check factor levels
levels(infect_timestep$time_to_infect)
col2rgb(c("lightblue","lightgreen","pink"))
t_col <- function(color, percent = 50, name = NULL) {
rgb.val <- col2rgb(color)
t.col <- rgb(rgb.val[1], rgb.val[2], rgb.val[3], max = 255, alpha = (100 - percent) * 255/100, names = name)
invisible(t.col)
}
t_col <- t_col("gray80", perc = 50, name = "lt.gray")
#set up colors (and color names for legend)
timestep_colors <- c("red",t_col, viridis(6))
names(timestep_colors) <-  c("Initially Infested", "No Modeled Infestation", "1", "2", "3", "4", "5", "6")
#ggplot
ggplot() +
#plot the us map data
geom_sf(data = USmaps_sf) +
#then add the infected lake data
geom_sf(data = TXmaps_sf) +
geom_sf(data = infect_timestep, aes(color = time_to_infect)) +
#use timestep colors
scale_color_manual(values = timestep_colors) +
#title of legend
labs(color = "Time to Infection") +
#use theme_void so we dont have grid lines
theme_void() +
#plot title
labs(title = "HSI, 100 mi Buffer, 50% Cleaning") +
#set title size and legend position
theme(plot.title = element_text(hjust = 0.5),
legend.position = "left")
#This line will save the last ggplot rendered (so the plot above will be saved)
ggsave(here("Infect_Plot_HSI_Buff_100_50_Percent_Cleaning_Station.png"), bg = "white")
knitr::opts_chunk$set(echo = TRUE)
#install.packages("unikn")
library(tidyverse) # library to read excel files
library(readxl)
library(writexl)
library(ggplot2)
library(here) #this automatically sets working directory to location of file
#library(cowplot)
#library(unikn)
#library(patchwork)
library(rgdal) # library for GIS functions
library(sp) # library for GIS functions (dependency for rgdal)
# read in excel file, arguments are file name and sheet name
#setwd("C:/Users/RDEL1CMC/Desktop/JA/Second_Revision/Results_08232022")
#instead of file path, Iris used here() fun to set wd
init_infect_dat <- read_xlsx(here("initial_infected.xlsx"))
init_dat <- read_xlsx(here("initial_uninfected.xlsm"))
dat <- read_xlsx(here("HSI_Buff_100_75_Percent_Cleaning_Station.xlsx"), sheet="Lake_Results_0")
# subset by only infections (i.e. Infections = True; column Infected. == T)
# The "," in the brackets after "T" means to select all rows
infect_dat <- dat[dat$Infected==TRUE,]
#init_dat is the initial infected data file that also has the uninfected lakes
# Note, there are probably a lot of ways to do this part
# Sort data in ascending order by Iteration and Lake, so all lakes infected at
# time step 0 are listed in alphabetical order
infect_dat_sort <- infect_dat[with(infect_dat, order(Iteration, Lake)),]
#sort initial infected data by iteration and lake
# Select the time step when lake is first infected
# the "!" means not, so this is selecting the rows where where the Lake name is
# not duplicated (i.e. the first time it occurs in the data frame)
infect_dat_first <- infect_dat_sort[!duplicated(infect_dat_sort$Lake),]
infect_dat_first$newtimestep <- infect_dat_first$Iteration+1
init_dat$newtimestep <- init_dat$Iteration
#NOTE. Iris did not use this code at all...just double checking I used the right data!
# save dataset as Excel file -- the row.names=F argument means not to include
# column in Excel sheet with index value
write_xlsx(infect_dat_first, "HSI_Buff_100_75_Percent_Cleaning_Station.xlsx")
#combine the excel files into one file to plot
#lake is never infected if FID is in the init dat but not in the infect dat first
never_infected <- init_dat %>% filter(!FID %in% c(infect_dat_first$FID)) %>% mutate(newtimestep = "No Modeled Infestation")
#Iris added a HSI column so they would bind
#Carra rearranged to get the never infested lakes to show up on the bottom of the image
combined <- rbind(infect_dat_first, never_infected %>% mutate(HSI = NA))
combined
combined_sort <- combined[with(combined, order(Lake, Iteration)),]
combined_sort
combined_sort$Lake[combined_sort$Infected==T & combined_sort$Iteration==0]
#pulling out initially infected lakes based on FID
combined_sort__not_initially_infected <-combined_sort[combined_sort$FID %in% c(53, 87, 90, 138, 180, 213, 216, 217, 220, 221, 317),]
combined_sort__not_initially_infected
combined_sort$newtimestep[combined_sort$FID %in% c(53, 87, 90, 138, 180, 213, 216, 217, 220, 221, 317)] = 0
combined_sort
# Convert to spatial points data frame and project in WGS84 (i.e. Degrees)
# The CRS stands for coordinate reference system and I googled the code to put in (4326)
coordinates(combined) <- ~Longitude+Latitude
proj4string(combined) <- CRS("+init=epsg:4326")
coordinates(infect_dat_first) <- ~Longitude+Latitude
proj4string(infect_dat_first) <- CRS("+init=epsg:4326")
coordinates(init_infect_dat) <- ~Longitude+Latitude
proj4string(init_infect_dat) <- CRS("+init=epsg:4326")
coordinates(init_dat) <- ~Longitude+Latitude
proj4string(init_dat) <- CRS("+init=epsg:4326")
# Save Spatial Points data frame as shapefile
# Note, this abbreviates the field names
writeOGR(combined, "infect_dat_first_HSI_Buff_100_75_Percent_Cleaning_Station.shp", layer="infect_dat_first", driver="ESRI Shapefile")
# USmaps <- readOGR(#"C:/Users/RDEL1CMC/Desktop/JA/Second_Revision/Results_08232022",
#                   "US_STATES.shp")
# USBR_INPUT <-readOGR(#"C:/Users/RDEL1CMC/Desktop/JA/Second_Revision/Results_08232022",
#                      "USBR_INPUT.shp")
# us_lakes <- readOGR(#"C:/Users/RDEL1CMC/Desktop/JA/Second_Revision/Results_08232022",
#   "Waterbodies_High_Res_NHD_1000ft_From_Site_Join_Final_6_1_18_A.shp")
# # Time of Infection PlotNuk
# #png("Infect_Plot_HSI_Buff_100.png")
# plot(USmaps)
# plot(us_lakes, add=TRUE)
# plot(combined_sort, bg=as.factor(combined_sort@data$newtimestep), pch=16, cex=1, col = 1:6, add = TRUE)
#
# #plots initial uninfected data
# (plot(init_dat, bg=as.factor(init_dat@data$Infected), pch=16, cex=1, col = 1, add = TRUE))
#
# #plots the time step that infected lakes become infected
# plot(infect_dat_first, bg=as.factor(infect_dat_first@data$newtimestep), pch=16, cex=1, col = 3:7, add = TRUE)
#
# #plots the initial 11 infected lakes
# plot(init_dat, bg=as.factor(init_dat@data$Infected), pch=16, cex=1, col = 10, add = TRUE)
#
#
# #legend for the time step of infection
# legend("bottomleft", legend=as.factor(unique(combined_sort@data$newtimestep)), pch=21, col = 1:6, pt.bg=palette()[1:6],
#              pt.cex=1, title="Time of Infection", bty="n", ncol = 2)
# legend("bottomleft", legend=as.factor(unique(infect_dat_first@data$newtimestep)), pch=21, col = 3:7,
#              pt.bg=palette()[3:7], pt.cex=1, title="Time of Infection", bty="n", ncol = 2)
# #legend for initial uninfected
# legend("bottomright", legend=as.factor(unique(init_dat@data$Iteration)), pch=16,
#        pt.bg=palette()[9], pt.cex=1, title="initial Uninfected", bty="n", ncol = 2)
# #legend for initial infected
# legend("bottom", legend=as.factor(unique(init_dat@data$Infected)), pch=16, col = "red",
#       pt.bg="red", pt.cex=1, title="Initial Infected", bty="n", ncol = 2)
# title(main = "Infection based on Time Step", sub = "Null no buffer Survive 100")
# #dev.off()
#IRIS'S ATTEMPT WITH SF PACKAGE
library(sf) #for spatial data
library(scales) #for color scales
library(viridis)
#Read this in as sf object
USmaps_sf <- read_sf(here("Carra_Lakes.shp"))
TXmaps_sf <- read_sf(here("State.shp"))
#Convert these to sp objects to sf
infected_dat_first_sf <- st_as_sf(infect_dat_first)
init_infect_dat_sf <- st_as_sf(init_infect_dat) %>% mutate(newtimestep = "Initially Infested")
combined_sort_sf <- st_as_sf(combined)
#Remove lakes from infected_dat_first if they are initially infected
combined_sort_sf <- combined_sort_sf %>%
filter(!FID %in% c(init_infect_dat_sf$FID))
#rbind initially infected with infected first, create factor version of newtimestep
infect_timestep <- rbind(combined_sort_sf , init_infect_dat_sf %>% mutate(HSI = NA)) %>%
mutate(time_to_infect = as.character(newtimestep)) #%>%
#if timestep is 0, lake is initially infected, if it is 6, it is never infected
# mutate(time_to_infect = case_when(time_to_infect == 0 ~ "Initially Infected",
#                                  T ~ time_to_infect))
#order factor levels
infect_timestep$time_to_infect <- factor(infect_timestep$time_to_infect, levels = c("Initially Infested", "No Modeled Infestation", "1", "2", "3", "4", "5", "6"), ordered = T)
#check factor levels
levels(infect_timestep$time_to_infect)
col2rgb(c("lightblue","lightgreen","pink"))
t_col <- function(color, percent = 50, name = NULL) {
rgb.val <- col2rgb(color)
t.col <- rgb(rgb.val[1], rgb.val[2], rgb.val[3], max = 255, alpha = (100 - percent) * 255/100, names = name)
invisible(t.col)
}
t_col <- t_col("gray80", perc = 50, name = "lt.gray")
#set up colors (and color names for legend)
timestep_colors <- c("red",t_col, viridis(6))
names(timestep_colors) <-  c("Initially Infested", "No Modeled Infestation", "1", "2", "3", "4", "5", "6")
#ggplot
ggplot() +
#plot the us map data
geom_sf(data = USmaps_sf) +
#then add the infected lake data
geom_sf(data = TXmaps_sf) +
geom_sf(data = infect_timestep, aes(color = time_to_infect)) +
#use timestep colors
scale_color_manual(values = timestep_colors) +
#title of legend
labs(color = "Time to Infection") +
#use theme_void so we dont have grid lines
theme_void() +
#plot title
labs(title = "HSI, 100 mi Buffer, 75% Cleaning") +
#set title size and legend position
theme(plot.title = element_text(hjust = 0.5),
legend.position = "left")
#This line will save the last ggplot rendered (so the plot above will be saved)
ggsave(here("Infect_Plot_HSI_Buff_100_75_Percent_Cleaning_Station.png"), bg = "white")
library(ggplot2)
library(readxl)
library(tidyr) # This library is necessary for converting the dataframe from long to wide format (pivot_wider function)
setwd("C:/Users/RDEL1CMC/Desktop/Congressional_Ad_Projects/Dreissenid_Mussel_Model/Results/") # set to your working directory
dat <- read_excel("Test_Sensitivity_Results.xlsx")
dat <- dat[c(1,3:4)] # I dropped the "parameter" variable -- necessary to use pivot_wider
dat$RunNumber <- paste("Run",dat$RunNumber, sep="") # Converting from number type to string
# pivot_wider makes a column for each RunNumber
# This way you can select min/max for the geom_ribbon function
dat %>%
ggplot(aes(x = TimeStep)) +
#ylim(0,325) +
scale_x_continuous(limits = c(1,7), expand = c(0,0)) +
scale_y_continuous(limits = c(0,350), expand = c(0,0), breaks = seq(0, 350, 50)) +
geom_ribbon(
data = ~ pivot_wider(., names_from = RunNumber, values_from = infested),
aes(ymin = Run6, ymax = Run10), fill = "blue", alpha = 0.25
) +
geom_line(aes(y = infested,
linetype=RunNumber), # added line type back inside "aes"
color= "black", # added color outside "aes" so all would be black
lwd  = 0.5, )  +
scale_linetype_manual(name = "", values = c("dashed", "solid", "dotted")) +
ylab("Number of lakes infested") + xlab("Timestep") +
theme_bw() +
theme(legend.position = "none") +# this takes out the legend
theme(axis.text=element_text(size=12), axis.title=element_text(size=14))+ # Changes the font size of axes labels
theme(panel.grid.minor = element_blank()) # takes out the minor grid lines -- I did this because you don't have 0.5 timesteps
ggsave("HSI_12222022.jpg", height=10, width=8)
library(ggplot2)
library(readxl)
library(tidyr) # This library is necessary for converting the dataframe from long to wide format (pivot_wider function)
setwd("C:/Users/RDEL1CMC/Desktop/Congressional_Ad_Projects/Dreissenid_Mussel_Model/Results/") # set to your working directory
dat <- read_excel("Test_Sensitivity_Results.xlsx")
dat <- dat[c(1,3:4)] # I dropped the "parameter" variable -- necessary to use pivot_wider
dat$RunNumber <- paste("Run",dat$RunNumber, sep="") # Converting from number type to string
# pivot_wider makes a column for each RunNumber
# This way you can select min/max for the geom_ribbon function
dat %>%
ggplot(aes(x = TimeStep)) +
#ylim(0,325) +
scale_x_continuous(limits = c(1,7), expand = c(0,0)) +
scale_y_continuous(limits = c(0,350), expand = c(0,0), breaks = seq(0, 350, 50)) +
geom_ribbon(
data = ~ pivot_wider(., names_from = RunNumber, values_from = infested),
aes(ymin = Run6, ymax = Run10), fill = "blue", alpha = 0.25
) +
geom_line(aes(y = infested,
linetype=RunNumber), # added line type back inside "aes"
color= "black", # added color outside "aes" so all would be black
lwd  = 0.5, )  +
scale_linetype_manual(name = "", values = c("dashed", "solid", "dotted")) +
ylab("Number of lakes infested") + xlab("Timestep") +
theme_bw() +
theme(legend.position = "none") +# this takes out the legend
theme(axis.text=element_text(size=12), axis.title=element_text(size=14))+ # Changes the font size of axes labels
theme(panel.grid.minor = element_blank()) # takes out the minor grid lines -- I did this because you don't have 0.5 timesteps
ggsave("HSI_12222022.jpg", height=10, width=8)
library(ggplot2)
library(readxl)
library(tidyr) # This library is necessary for converting the dataframe from long to wide format (pivot_wider function)
setwd("C:/Users/RDEL1CMC/Desktop/Congressional_Ad_Projects/Dreissenid_Mussel_Model/Results/") # set to your working directory
dat <- read_excel("Test_Sensitivity_Results.xlsx")
dat <- dat[c(1,3:4)] # I dropped the "parameter" variable -- necessary to use pivot_wider
dat$RunNumber <- paste("Run",dat$RunNumber, sep="") # Converting from number type to string
# pivot_wider makes a column for each RunNumber
# This way you can select min/max for the geom_ribbon function
dat %>%
ggplot(aes(x = TimeStep)) +
#ylim(0,325) +
scale_x_continuous(limits = c(1,7), expand = c(0,0)) +
scale_y_continuous(limits = c(0,350), expand = c(0,0), breaks = seq(0, 350, 50)) +
geom_ribbon(
data = ~ pivot_wider(., names_from = RunNumber, values_from = infested),
aes(ymin = Run10, ymax = Run6), fill = "blue", alpha = 0.25
) +
geom_line(aes(y = infested,
linetype=RunNumber), # added line type back inside "aes"
color= "black", # added color outside "aes" so all would be black
lwd  = 0.5, )  +
scale_linetype_manual(name = "", values = c("dashed", "solid", "dotted")) +
ylab("Number of lakes infested") + xlab("Timestep") +
theme_bw() +
theme(legend.position = "none") +# this takes out the legend
theme(axis.text=element_text(size=12), axis.title=element_text(size=14))+ # Changes the font size of axes labels
theme(panel.grid.minor = element_blank()) # takes out the minor grid lines -- I did this because you don't have 0.5 timesteps
ggsave("HSI_12222022.jpg", height=10, width=8)
library(ggplot2)
library(readxl)
library(tidyr) # This library is necessary for converting the dataframe from long to wide format (pivot_wider function)
setwd("C:/Users/RDEL1CMC/Desktop/Congressional_Ad_Projects/Dreissenid_Mussel_Model/Results/") # set to your working directory
dat <- read_excel("Test_Sensitivity_Results.xlsx")
dat <- dat[c(1,3:4)] # I dropped the "parameter" variable -- necessary to use pivot_wider
dat$RunNumber <- paste("Run",dat$RunNumber, sep="") # Converting from number type to string
# pivot_wider makes a column for each RunNumber
# This way you can select min/max for the geom_ribbon function
dat %>%
ggplot(aes(x = TimeStep)) +
#ylim(0,325) +
scale_x_continuous(limits = c(1,7), expand = c(0,0)) +
scale_y_continuous(limits = c(0,350), expand = c(0,0), breaks = seq(0, 350, 50)) +
geom_ribbon(
data = ~ pivot_wider(., names_from = RunNumber, values_from = infested),
aes(ymin = Run10, ymax = Run6), fill = "blue", alpha = 0.25
) +
geom_line(aes(y = infested,
linetype=RunNumber), # added line type back inside "aes"
color= "black", # added color outside "aes" so all would be black
lwd  = 0.5, )  +
scale_linetype_manual(name = "", values = c("dashed", "dotted", "solid")) +
ylab("Number of lakes infested") + xlab("Timestep") +
theme_bw() +
theme(legend.position = "none") +# this takes out the legend
theme(axis.text=element_text(size=12), axis.title=element_text(size=14))+ # Changes the font size of axes labels
theme(panel.grid.minor = element_blank()) # takes out the minor grid lines -- I did this because you don't have 0.5 timesteps
ggsave("HSI_12222022.jpg", height=10, width=8)
library(ggplot2)
library(readxl)
library(tidyr) # This library is necessary for converting the dataframe from long to wide format (pivot_wider function)
setwd("C:/Users/RDEL1CMC/Desktop/Congressional_Ad_Projects/Dreissenid_Mussel_Model/Results/") # set to your working directory
dat <- read_excel("Test_Sensitivity_Results.xlsx")
dat <- dat[c(1,3:4)] # I dropped the "parameter" variable -- necessary to use pivot_wider
dat$RunNumber <- paste("Run",dat$RunNumber, sep="") # Converting from number type to string
# pivot_wider makes a column for each RunNumber
# This way you can select min/max for the geom_ribbon function
dat %>%
ggplot(aes(x = TimeStep)) +
#ylim(0,325) +
scale_x_continuous(limits = c(1,7), expand = c(0,0)) +
scale_y_continuous(limits = c(0,350), expand = c(0,0), breaks = seq(0, 350, 50)) +
geom_ribbon(
data = ~ pivot_wider(., names_from = RunNumber, values_from = infested),
aes(ymin = Run6, ymax = Run10), fill = "blue", alpha = 0.25
) +
geom_line(aes(y = infested,
linetype=RunNumber), # added line type back inside "aes"
color= "black", # added color outside "aes" so all would be black
lwd  = 0.5, )  +
scale_linetype_manual(name = "", values = c("dashed", "dotted", "solid")) +
ylab("Number of lakes infested") + xlab("Timestep") +
theme_bw() +
theme(legend.position = "none") +# this takes out the legend
theme(axis.text=element_text(size=12), axis.title=element_text(size=14))+ # Changes the font size of axes labels
theme(panel.grid.minor = element_blank()) # takes out the minor grid lines -- I did this because you don't have 0.5 timesteps
ggsave("HSI_12222022.jpg", height=10, width=8)
